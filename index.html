<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bulk WhatsApp Sender</title>
</head>
<body>

<h2>Bulk WhatsApp Sender</h2>
<button onclick="fetchAndSend()">Fetch Data & Generate WhatsApp Links</button>

<ul id="linkList"></ul>

<script>
const SHEET_URL = 'https://script.google.com/macros/s/AKfycbwbs8kMjd_iIR2Vn-YXrvz-NcdOS8mNjILqlRiwhcxndIn0BqAZqd9Bft43i1WNQ0DO/exec';  // Replace with your Google Apps Script web app URL

async function fetchAndSend() {
    try {
        const response = await fetch(SHEET_URL);
        const data = await response.json();

        const listContainer = document.getElementById('linkList');
        listContainer.innerHTML = ''; // Clear previous list

        data.forEach(person => {
            const { phone, message } = person;
            const whatsappLink = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;

            const listItem = document.createElement('li');
            const link = document.createElement('a');
            link.href = whatsappLink;
            link.target = '_blank';
            link.textContent = `Send message to ${phone}`;

            listItem.appendChild(link);
            listContainer.appendChild(listItem);
        });

        alert('Links generated. Click on each link to send messages.');
    } catch (error) {
        console.error('Error fetching data:', error);
        alert('Failed to fetch data from Google Sheets.');
    }
}
</script>

</body>
</html>
